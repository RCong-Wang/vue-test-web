"use strict";(self["webpackChunkmy_vue_app"]=self["webpackChunkmy_vue_app"]||[]).push([[673],{8673:function(e,t,s){s.r(t),s.d(t,{default:function(){return _}});var o=s(3396),r=s(7139),n=s(9242);const a=(0,o._)("p",null,"good",-1),i=["onClick"],c=(0,o._)("label",{for:"search-box"},"搜尋好友: ",-1);function d(e,t,s,d,l,h){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",null,[a,(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.Friends,(e=>((0,o.wg)(),(0,o.iD)("li",{key:e.friend_id},[(0,o._)("button",{onClick:t=>h.EnterChatroom(e.friend_id)},(0,r.zw)(e.friend_id)+"_"+(0,r.zw)(e.friend_name),9,i)])))),128))])]),(0,o._)("div",null,[c,(0,o.wy)((0,o._)("input",{type:"text",id:"search-box","onUpdate:modelValue":t[0]||(t[0]=e=>l.search_box=e)},null,512),[[n.nr,l.search_box]]),(0,o._)("button",{onClick:t[1]||(t[1]=(...e)=>h.SearchFriend&&h.SearchFriend(...e))},"搜尋")]),(0,o._)("div",null,[l.user_id?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:t[2]||(t[2]=(...e)=>h.AddFriend&&h.AddFriend(...e))},(0,r.zw)(l.user_name),1)):(0,o.kq)("",!0)])],64)}s(560);var l={name:"Friend",created(){this.axios=(0,o.f3)("axios"),this.FriendList()},data(){return{search_box:"",user_id:null,user_name:"",Friends:[]}},methods:{FriendList(){this.axios.get(`${this.local_http}/user/friendlist/`).then((e=>{this.Friends=e.data.friends,console.log(this.Friends)})).catch((e=>{console.error("好友清單錯誤",e)})),console.log("good")},SearchFriend(){this.axios.get(`${this.local_http}/user/searchfriend/`,{params:{username:this.search_box}}).then((e=>{this.user_id=e.data.user_id,this.user_name=e.data.user,console.log("搜尋成功: ",e.data)})).catch((e=>{console.error("搜尋失敗",e)}))},AddFriend(){this.axios.get(`${this.local_http}/user/getcsrf/`).then((e=>{const t=e.data.csrf_token;console.log(t),this.axios.post(`${this.local_http}/user/addfriend/`,this.user_id,{withCredentials:!0,headers:{"X-CSRFToken":t,"Content-Type":"application/json"}}).then((e=>{this.FriendList(),e&&e.data?console.log("成功回應:",e.data):(console.log("成功回應:",e),console.error("回應未定義或缺少數據"))})).catch((e=>{e.response&&e.response.data?console.error("錯誤訊息:",e.response.data):console.error("發生錯誤:",e)}))}))},EnterChatroom(e){console.log(e),this.axios.get(`${this.local_http}/main/isexistchatroom/`,{params:{id:e}}).then((t=>{console.log("搜尋成功",t.data),t.data.success?(this.$store.dispatch("updateroomid",t.data.success),this.$router.push("chatroom/")):this.axios.get(`${this.local_http}/user/getcsrf/`).then((t=>{const s=t.data.csrf_token;console.log(s),this.axios.post(`${this.local_http}/main/createchatroom/`,e,{withCredentials:!0,headers:{"X-CSRFToken":s,"Content-Type":"application/json"}}).then((e=>{this.$store.dispatch("updateroomid",e.data.success),this.$router.push("chatroom/")})).catch((e=>{console.error("創建聊天室失敗:",e)}))}))})).catch((e=>{console.error("進入聊天室錯誤:",e)}))}}},h=s(89);const u=(0,h.Z)(l,[["render",d]]);var _=u}}]);
//# sourceMappingURL=673.20b4a883.js.map