"use strict";(self["webpackChunkmy_vue_app"]=self["webpackChunkmy_vue_app"]||[]).push([[302],{6302:function(e,s,t){t.r(s),t.d(s,{default:function(){return p}});var o=t(3396),r=t(7139),n=t(9242);const a=(0,o._)("p",null,"good",-1),d=["onClick"],i=(0,o._)("label",{for:"search-box"},"搜尋好友: ",-1);function c(e,s,t,c,h,l){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",null,[a,(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(h.Friends,(e=>((0,o.wg)(),(0,o.iD)("li",{key:e.friend_id},[(0,o._)("button",{onClick:s=>l.EnterChatroom(e.friend_id)},(0,r.zw)(e.friend_id)+"_"+(0,r.zw)(e.friend_name),9,d)])))),128))])]),(0,o._)("div",null,[i,(0,o.wy)((0,o._)("input",{type:"text",id:"search-box","onUpdate:modelValue":s[0]||(s[0]=e=>h.search_box=e)},null,512),[[n.nr,h.search_box]]),(0,o._)("button",{onClick:s[1]||(s[1]=(...e)=>l.SearchFriend&&l.SearchFriend(...e))},"搜尋")]),(0,o._)("div",null,[h.user_id?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:s[2]||(s[2]=(...e)=>l.AddFriend&&l.AddFriend(...e))},(0,r.zw)(h.user_name),1)):(0,o.kq)("",!0)])],64)}t(560);var h={name:"Friend",created(){this.axios=(0,o.f3)("axios"),this.FriendList()},data(){return{search_box:"",user_id:null,user_name:"",Friends:[]}},methods:{FriendList(){this.axios.get("https://5e0d-2401-e180-8d23-1fdd-b1d6-64a-7746-e486.ngrok-free.app/user/friendlist/").then((e=>{this.Friends=e.data.friends,console.log(this.Friends)})).catch((e=>{console.error("好友清單錯誤",e)})),console.log("good")},SearchFriend(){this.axios.get("https://5e0d-2401-e180-8d23-1fdd-b1d6-64a-7746-e486.ngrok-free.app/user/searchfriend/",{params:{username:this.search_box}}).then((e=>{this.user_id=e.data.user_id,this.user_name=e.data.user,console.log("搜尋成功: ",e.data)})).catch((e=>{console.error("搜尋失敗",e)}))},AddFriend(){this.axios.get("https://5e0d-2401-e180-8d23-1fdd-b1d6-64a-7746-e486.ngrok-free.app/user/getcsrf/").then((e=>{const s=e.data.csrf_token;console.log(s),this.axios.post("https://5e0d-2401-e180-8d23-1fdd-b1d6-64a-7746-e486.ngrok-free.app/user/addfriend/",this.user_id,{withCredentials:!0,headers:{"X-CSRFToken":s,"Content-Type":"application/json"}}).then((e=>{this.FriendList(),e&&e.data?console.log("成功回應:",e.data):(console.log("成功回應:",e),console.error("回應未定義或缺少數據"))})).catch((e=>{e.response&&e.response.data?console.error("錯誤訊息:",e.response.data):console.error("發生錯誤:",e)}))}))},EnterChatroom(e){console.log(e),this.axios.get("https://5e0d-2401-e180-8d23-1fdd-b1d6-64a-7746-e486.ngrok-free.app/main/isexistchatroom/",{params:{id:e}}).then((s=>{console.log("搜尋成功",s.data),s.data.success?(this.$store.dispatch("updateroomid",s.data.success),this.$router.push("chatroom/")):this.axios.get("https://5e0d-2401-e180-8d23-1fdd-b1d6-64a-7746-e486.ngrok-free.app/user/getcsrf/").then((s=>{const t=s.data.csrf_token;console.log(t),this.axios.post("https://5e0d-2401-e180-8d23-1fdd-b1d6-64a-7746-e486.ngrok-free.app/main/createchatroom/",e,{withCredentials:!0,headers:{"X-CSRFToken":t,"Content-Type":"application/json"}}).then((e=>{this.$store.dispatch("updateroomid",e.data.success),this.$router.push("chatroom/")})).catch((e=>{console.error("創建聊天室失敗:",e)}))}))})).catch((e=>{console.error("進入聊天室錯誤:",e)}))}}},l=t(89);const u=(0,l.Z)(h,[["render",c]]);var p=u}}]);
//# sourceMappingURL=302.b2cd2dd6.js.map