"use strict";(self["webpackChunkmy_vue_app"]=self["webpackChunkmy_vue_app"]||[]).push([[2],{2:function(e,a,s){s.r(a),s.d(a,{default:function(){return p}});var t=s(3396),o=s(7139),r=s(9242);const n=(0,t._)("p",null,"good",-1),i=["onClick"],c=(0,t._)("label",{for:"search-box"},"搜尋好友: ",-1);function d(e,a,s,d,h,l){return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("div",null,[n,(0,t._)("ul",null,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(h.Friends,(e=>((0,t.wg)(),(0,t.iD)("li",{key:e.friend_id},[(0,t._)("button",{onClick:a=>l.EnterChatroom(e.friend_id)},(0,o.zw)(e.friend_id)+"_"+(0,o.zw)(e.friend_name),9,i)])))),128))])]),(0,t._)("div",null,[c,(0,t.wy)((0,t._)("input",{type:"text",id:"search-box","onUpdate:modelValue":a[0]||(a[0]=e=>h.search_box=e)},null,512),[[r.nr,h.search_box]]),(0,t._)("button",{onClick:a[1]||(a[1]=(...e)=>l.SearchFriend&&l.SearchFriend(...e))},"搜尋")]),(0,t._)("div",null,[h.user_id?((0,t.wg)(),(0,t.iD)("button",{key:0,onClick:a[2]||(a[2]=(...e)=>l.AddFriend&&l.AddFriend(...e))},(0,o.zw)(h.user_name),1)):(0,t.kq)("",!0)])],64)}s(560);var h={name:"Friend",created(){this.axios=(0,t.f3)("axios"),this.FriendList()},data(){return{search_box:"",user_id:null,user_name:"",Friends:[]}},methods:{FriendList(){this.axios.get("https://aa0e-2401-e180-8850-ae-c03b-534a-dcee-f333.ngrok-free.app/user/friendlist/").then((e=>{this.Friends=e.data.friends,console.log(this.Friends)})).catch((e=>{console.error("好友清單錯誤",e)})),console.log("good")},SearchFriend(){this.axios.get("https://aa0e-2401-e180-8850-ae-c03b-534a-dcee-f333.ngrok-free.app/user/searchfriend/",{params:{username:this.search_box}}).then((e=>{this.user_id=e.data.user_id,this.user_name=e.data.user,console.log("搜尋成功: ",e.data)})).catch((e=>{console.error("搜尋失敗",e)}))},AddFriend(){this.axios.get("https://aa0e-2401-e180-8850-ae-c03b-534a-dcee-f333.ngrok-free.app/user/getcsrf/").then((e=>{const a=e.data.csrf_token;console.log(a),this.axios.post("https://aa0e-2401-e180-8850-ae-c03b-534a-dcee-f333.ngrok-free.app/user/addfriend/",this.user_id,{withCredentials:!0,headers:{"X-CSRFToken":a,"Content-Type":"application/json"}}).then((e=>{this.FriendList(),e&&e.data?console.log("成功回應:",e.data):(console.log("成功回應:",e),console.error("回應未定義或缺少數據"))})).catch((e=>{e.response&&e.response.data?console.error("錯誤訊息:",e.response.data):console.error("發生錯誤:",e)}))}))},EnterChatroom(e){console.log(e),this.axios.get("https://aa0e-2401-e180-8850-ae-c03b-534a-dcee-f333.ngrok-free.app/main/isexistchatroom/",{params:{id:e}}).then((a=>{console.log("搜尋成功",a.data),a.data.success?(this.$store.dispatch("updateroomid",a.data.success),this.$router.push("chatroom/")):this.axios.get("https://aa0e-2401-e180-8850-ae-c03b-534a-dcee-f333.ngrok-free.app/user/getcsrf/").then((a=>{const s=a.data.csrf_token;console.log(s),this.axios.post("https://aa0e-2401-e180-8850-ae-c03b-534a-dcee-f333.ngrok-free.app/main/createchatroom/",e,{withCredentials:!0,headers:{"X-CSRFToken":s,"Content-Type":"application/json"}}).then((e=>{this.$store.dispatch("updateroomid",e.data.success),this.$router.push("chatroom/")})).catch((e=>{console.error("創建聊天室失敗:",e)}))}))})).catch((e=>{console.error("進入聊天室錯誤:",e)}))}}},l=s(89);const u=(0,l.Z)(h,[["render",d]]);var p=u}}]);
//# sourceMappingURL=2.e462cf2a.js.map